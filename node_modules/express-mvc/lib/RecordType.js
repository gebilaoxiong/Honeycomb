/**
 *
 * @authors 熊洋 (xywindows@gmail.com)
 * @date    2014-06-23 21:04:12
 * @description 数据记录类型
 */
var Record,
  ObjectUtil = require('./ObjectUtil');

Record = function(options) {
  var me = this;

  me.idIndex = 0;
  ObjectUtil.extend(me, options);
}

Record.prototype = {
  /**
   * 唯一键
   * @type {String}
   */
  idProperty: 'id',

  /**
   * 是否为幽灵（未持久化）
   */
  isPhantom: function(data) {
    return data[this.idProperty] == undefined;
  },

  /**
   * 获取一个记录的ID不存在则添加
   * @param  {Object}     data      记录
   */
  id: function(data) {
    var me = this,
      idProperty = me.idProperty,
      id;

    id = data[idProperty] != undefined ?
      data[idProperty] :
      data[idProperty] = ++me.idIndex;

    return String(id);
  },

  /**
   * 获取数据的ID
   * @param  {Object}     data      记录
   */
  getId: function(data) {
    return String(data[this.idProperty]);
  }
}

module.exports = Record;